<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:ctx="http://www.springframework.org/schema/context"
       xmlns:camel="http://cxf.apache.org/transports/camel"
       xmlns:cxf="http://camel.apache.org/schema/cxf"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
       http://cxf.apache.org/transports/camel http://cxf.apache.org/transports/camel.xsd
       http://camel.apache.org/schema/cxf http://camel.apache.org/schema/cxf/camel-cxf.xsd
">
     <context:property-placeholder
        location="classpath:META-INF/tarjonta-esb.properties, file:///${user.home:''}/oph-configuration/common.properties, file:///${user.home:''}/oph-configuration/tarjonta-esb.properties"
        ignore-resource-not-found="true"/>
     
         <!-- Define "listening" endpoint for haku Web Service -->
    <cxf:cxfEndpoint
        id="tarjontaAdminRouter"
        address="/tarjontaAdminService"
        serviceClass="fi.vm.sade.tarjonta.service.TarjontaAdminService"
    >
    </cxf:cxfEndpoint>
    
             <!-- Define "listening" endpoint for haku Web Service -->
    <cxf:cxfEndpoint
        id="tarjontaPublicRouter"
        address="/tarjontaPublicService"
        serviceClass="fi.vm.sade.tarjonta.service.TarjontaPublicService"
    >
    </cxf:cxfEndpoint>
    
    <!-- define camel route with camel conduit which uses camel's own transport -->
    <camel:conduit name="*.camel-conduit">     
        <camelContext id="camelContext-tarjonta" xmlns="http://camel.apache.org/schema/spring">
            <endpoint id="callBackendTarjontaAdminService" uri="${tarjonta.admin.webservice.url.backend}?throwExceptionOnFailure=false"/>
            <endpoint id="callBackendTarjontaPublicService" uri="${tarjonta.public.webservice.url.backend}?throwExceptionOnFailure=false"/>
            <route id="tarjontaAdminRoute" >
                <from uri="cxf:bean:tarjontaAdminRouter?dataFormat=MESSAGE" />
                <to ref="callBackendTarjontaAdminService"/>
            </route>
            <route id="tarjontaPublicRoute" >
                <from uri="cxf:bean:tarjontaPublicRouter?dataFormat=MESSAGE" />
                <to ref="callBackendTarjontaPublicService" />
            </route>
        </camelContext>
    </camel:conduit>
    
</beans>
